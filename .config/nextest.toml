## Nextest configuration
# See docs/code/test-organization.md for test organization and filtering details.

# Unit tests: #[cfg(test)] tests in lib and bin targets (excluding it_* modules)
[profile.unit]
default-filter = '(kind(lib) + kind(bin)) - test(/::it_/) - package(tests) - package(ampup)'

# Integration tests: <crate>/tests/ directories and it_* modules in lib/bin sources
[profile.integration]
default-filter = '(kind(test) + test(/::it_/)) - package(tests) - package(ampup)'
retries = 1

# E2E tests: top-level tests/ package
[profile.e2e]
default-filter = 'package(tests)'
retries = 1

[profile.ampup]
default-filter = 'package(ampup)'

[profile.local]
# Local development: all tests except ampup, external deps, and flaky tests
default-filter = '''
  all()
  - package(ampup)
  - test(tests::it_admin_api_datasets_stop_job::stop_already_stopped_job_is_idempotent)
  - test(tests::it_admin_api_datasets_stop_job::stop_completed_job_is_idempotent)
  - test(tests::it_admin_api_datasets_stop_job::stop_running_job_succeeds)
  - test(tests::it_dependencies::intra_deps_test)
  - test(tests::it_dependencies::multi_version_test)
  - test(tests::it_dump::base_firehose_single_dump)
  - test(tests::it_dump::eth_firehose_single_dump)
  - test(tests::it_dump::evm_rpc_base_single_dump)
  - test(tests::it_dump::evm_rpc_base_single_dump_fetch_receipts_per_tx)
  - test(tests::it_dump::evm_rpc_single_dump)
  - test(tests::it_dump::evm_rpc_single_dump_fetch_receipts_per_tx)
  - test(tests::it_solana_historical_to_json_rpc_transition::historical_to_json_rpc_transition)
  - test(tests::it_sql::sql_tests)
  - test(tests::it_sql_dataset_batch_size::sql_dataset_input_batch_size)
  - test(tests::it_streaming::streaming_tests_with_sql_datasets)
'''
