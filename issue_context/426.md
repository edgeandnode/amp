# Issue 426: Multiplex streaming query notifications

## Objective
Replace per-location PostgreSQL LISTEN connections in streaming queries with a single multiplexed connection to improve scalability and reduce database connection usage.

## Problem
- Each streaming query creates one DB connection per table location via `MetadataDb::listen()` 
- Channels named `"change-tracking-physical-table-id:{location_id}"` result in many individual connections
- Poor scalability with large numbers of tables

## Solution approach
- Single PostgreSQL connection listening to unified `"change-tracking"` channel
- Parse location_id from notification payload to route to appropriate tokio::watch channels
- Replace individual PostgreSQL notification streams with tokio::watch::Receiver<()> per location
- Update notification senders to include location_id in payload instead of empty string

## Key implementation points
- New `NotificationMultiplexer` service in `common/src/notification_multiplexer.rs`
- Update `watermark_updates()` in `streaming_query.rs` to use multiplexer.subscribe()
- Modify `parquet_writer.rs` to send location_id in notification payload
- Add `notify_location_change()` convenience method to MetadataDb
- No need for deregistration since tokio::watch senders are lightweight

## Files affected
- `common/src/notification_multiplexer.rs` (new)
- `common/src/streaming_query.rs` 
- `dump/src/parquet_writer.rs`
- `metadata-db/src/lib.rs`
- `common/src/stream_helpers.rs`